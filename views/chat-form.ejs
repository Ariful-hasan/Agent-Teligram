
    <div class="row">

        <% if (data.type == "A") { %>
            <div class="col-md-2">
                <div class="card card-info">
                    <div class="card-header">User in List</div>
                    <div class="card-body">

                    </div>
                </div>
            </div>
        <% } %>


        <div class=" <%= data.type == 'U'? 'offset-md-2' : '' %> col-md-8">
            <div class="card">
                <div class="card-header">
                    <div class="col-md-6">Chat</div>
                    <div class="col-md-6"><a class="pull-right" href="/logout">Log Out</a></div>
                </div>
                <div class="card-body">

                    <% if (data.userid) { %>
                    <div class="alert alert-info alert-dismissible fade show invisible" role="alert" id="alert">
                        <strong id="connection_msg"></strong>
                        <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span
                                aria-hidden="true">&times;</span></button>
                    </div>

                    <div class="col-md-12 invisible">
                        <div class="card">
                            <div class="card-body">
                                <ul id="msg_list"></ul>
                            </div>
                        </div>
                    </div>

                    <div class="col-md-12 mb-0">
                        <form action="" method="POST">
                            <div class="input-group mb-3">
                                <input type="text" class="form-control" placeholder="message" aria-label="message"
                                    id="message" aria-describedby="basic-addon2">
                                <div class="input-group-append">
                                    <button class="btn btn-outline-info" type="submit">Send</button>
                                </div>
                            </div>
                        </form>
                    </div>
                    <% } %>

                </div>
            </div>
        </div>
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script>

        $(function () {
            
            <% if (data.userid) { %>

                let chatUrl = "<%= typeof data.chatUrl != 'undefined' ? data.chatUrl : '' %>";
                let socket = io(chatUrl);

                socket.on('connect', () => {
                    console.log(socket.connected); // true
                    socket.emit("chat-join", "Hello server from client");
                });
                socket.on('server msg', (data) => {
                    console.log(data);
                });
                socket.on('s_msg', (data) => {
                    $("#connection_msg").html(data);
                    $("#alert").removeClass('invisible');
                    $("#alert").addClass('visible');
                });

                $('form').submit(function (e) {
                    e.preventDefault();
                    socket.emit('chat message', $('#message').val());
                    $('#message').val('');
                    return false;
                });

            <% } %>

        });
    </script>
 